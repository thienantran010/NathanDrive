import{u as P}from"./vue-clipboard3-abb1cd37.js";import{u as j,b as q}from"./vue-router-128bc7ad.js";import{_ as z}from"./index-29e2e257.js";import{j as F,r,ag as _,o as s,c as p,a,V as T,P as f,T as k,O as v,F as g,S as u,U as x,bh as U,bf as H}from"./@vue-7298a6f3.js";import"./clipboard-2fdbe17c.js";import"./aplayer-d80f7f58.js";import"./element-plus-857d32b3.js";import"./lodash-es-36eb724a.js";import"./@vueuse-740eda15.js";import"./@element-plus-925c7e21.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-c95324ad.js";import"./async-validator-10c6301d.js";import"./memoize-one-297ddbcb.js";import"./escape-html-85da7166.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-d10d3e5d.js";import"./vue-cookies-9b55b892.js";import"./@highlightjs-b388fc70.js";import"./highlight.js-cc51af62.js";import"./axios-4a70c6fc.js";import"./docx-preview-b41ea745.js";import"./jszip-d9c085e9.js";import"./xlsx-04f2268f.js";import"./vue-pdf-embed-acd0b5a4.js";import"./vue-9ac0364e.js";import"./dplayer-ff9c2365.js";const A=n=>(U("data-v-74cd2b1e"),n=n(),H(),n),G={class:"top"},J=A(()=>a("span",{class:"iconfont icon-cancel"},null,-1)),K={class:"file-list"},Q=["onMouseenter","onMouseleave"],W=["title"],X={class:"op"},Y=["onClick"],Z=["onClick"],ee={__name:"Share",setup(n){const{toClipboard:C}=P(),{proxy:c}=F();j(),q();const y={loadDataList:"/share/loadShareList",cancelShare:"/share/cancelShare"},I=r(document.location.origin+"/share/"),N=[{label:"file name",prop:"fileName",scopedSlots:"fileName"},{label:"share time",prop:"shareTime",width:200},{label:"invalid time",prop:"expireTime",scopedSlots:"expireTime",width:200},{label:"view times",prop:"showCount",width:200}],l=r({}),O={extHeight:20,selectType:"checkbox"},S=async()=>{let t={pageNo:l.value.pageNo,pageSize:l.value.pageSize};t.category!=="all"&&delete t.filePid;let o=await c.Request({url:y.loadDataList,params:t});o&&(l.value=o.data)},$=t=>{l.value.list.forEach(o=>{o.showOp=!1}),t.showOp=!0},D=t=>{t.showOp=!1},L=async t=>{await C(`link:${I.value}${t.shareId} access code: ${t.code}`),c.Message.success("copy success")},i=r([]),M=t=>{i.value=[],t.forEach(o=>{i.value.push(o.shareId)})},d=r([]),R=()=>{i.value.length!=0&&(d.value=i.value,b())},w=t=>{d.value=[t.shareId],b()},b=async()=>{c.Confirm("do you really want to cancel shareï¼Ÿ",async()=>{await c.Request({url:y.cancelShare,params:{shareIds:d.value.join(",")}})&&(c.Message.success("cancel share success"),S())})};return(t,o)=>{const B=_("el-button"),m=_("icon"),V=_("Table");return s(),p("div",null,[a("div",G,[T(B,{type:"primary",disabled:i.value.length==0,onClick:R},{default:f(()=>[J,k("cancel share ")]),_:1},8,["disabled"])]),a("div",K,[T(V,{columns:N,showPagination:!0,dataSource:l.value,fetch:S,options:O,onRowSelected:M},{fileName:f(({index:E,row:e})=>[a("div",{class:"file-item",onMouseenter:h=>$(e),onMouseleave:h=>D(e)},[(e.fileType==3||e.fileType==1)&&e.status!==0?(s(),v(m,{key:0,cover:e.fileCover},null,8,["cover"])):(s(),p(g,{key:1},[e.folderType==0?(s(),v(m,{key:0,fileType:e.fileType},null,8,["fileType"])):u("",!0),e.folderType==1?(s(),v(m,{key:1,fileType:0})):u("",!0)],64)),e.showRename?u("",!0):(s(),p("span",{key:2,class:"file-name",title:e.fileName},[a("span",null,x(e.fileName),1)],8,W)),a("span",X,[e.showOp&&e.fileId?(s(),p(g,{key:0},[a("span",{class:"iconfont icon-link",onClick:h=>L(e)},"copy link",8,Y),a("span",{class:"iconfont icon-cancel",onClick:h=>w(e)},"cancel share",8,Z)],64)):u("",!0)])],40,Q)]),expireTime:f(({index:E,row:e})=>[k(x(e.validType==3?"forever":e.expireTime),1)]),_:1},8,["dataSource"])])])}}},$e=z(ee,[["__scopeId","data-v-74cd2b1e"]]);export{$e as default};
